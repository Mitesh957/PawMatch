<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PawMatch - Login Page</title>

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
</head>
<body>
    <nav>
        <div class="nav-wrapper #64b5f6 blue lighten-2">
          <a href="#" class="brand-logo">PawMatch</a>
          <ul id="nav-mobile" class="right">
            <li id="loginli"><a class="modal-trigger" href="#modal2">Login</a></li>
            <li id="signupli"><a class="modal-trigger" href="#modal1">Signup</a></li>
            <li id="logoutli" style="display: none;"><a onclick="logout()">Logout</a></li>
            <!-- Home link will be added dynamically after login -->
          </ul>
        </div>
    </nav>

    <!-- Signup Modal -->
    <div id="modal1" class="modal">
        <div class="modal-content">
            <h4>Signup</h4>
            <form autocomplete="off" onsubmit="signup(event)">
                <input type="email" id="signupEmail" placeholder="email" />
                <input type="password" id="signupPassword" placeholder="password" />
                <button class="btn waves-effect #64b5f6 blue lighten-2" type="submit">submit</button>   
            </form>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="modal2" class="modal">
        <div class="modal-content">
            <h4>Login</h4>
            <form autocomplete="off" onsubmit="login(event)">
                <input type="email" id="loginEmail" placeholder="email" />
                <input type="password" id="loginPassword" placeholder="password" />
                <button class="btn waves-effect #64b5f6 blue lighten-2" type="submit">submit</button>   
            </form>
        </div>
    </div>

    <!-- Edit Details Modal -->
    <div id="modal3" class="modal">
        <div class="modal-content">
            <h4>Edit your details</h4>
            <div class="file-field input-field">
                <div class="btn #64b5f6 blue lighten-2">
                    <span>Upload Photo</span>
                    <input type="file" accept="image/*" onchange="uploadImage(event)" />
                </div>
                <div class="file-path-wrapper">
                    <input class="file-path validate" type="text">
                </div>
            </div>
            <form autocomplete="off" id="editProfile" onsubmit="updateUserProfile(event)">
                <input type="email" name="profileEmail" placeholder="email" />
                <input type="text" name="name" placeholder="name" />
                <input type="text" name="phoneno" placeholder="phoneno" />
                <input type="text" name="Age" placeholder="Age" />
                <input type="text" name="portfolioUrl" placeholder="portfolio url" />
                <input type="text" name="State" placeholder="State" />
                <button class="btn waves-effect #64b5f6 blue lighten-2" type="submit">submit</button>   
            </form>
        </div>
    </div>

    <!-- Account Details Section -->
    <div class="center">
        <h3>Your Account Details</h3>
        <img id="proimg" class="circle" src="./assets/noimage.png" alt="noimage" style="width: 20%; height: auto;" />
        <div class="userDetails"></div>
    </div>

    <table id="table" style="display: none;">
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Age</th>
                <th>State</th>
                <th>Portfolio</th>
            </tr>
        </thead>
        <tbody id="tbody"></tbody>
    </table>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>  
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var elems = document.querySelectorAll('.modal');
            var instances = M.Modal.init(elems);
        });

        // Firebase setup
        var firebaseConfig = {
            apiKey: "AIzaSyCqTWhstnYIMAWxFKlFmhqV5kXfDsMwm7Q",
            authDomain: "work-vibe.firebaseapp.com",
            databaseURL: "https://work-vibe-default-rtdb.firebaseio.com",
            projectId: "work-vibe",
            storageBucket: "work-vibe.appspot.com",
            messagingSenderId: "657553447517",
            appId: "1:657553447517:web:b31d13b5e033c32d7a8bb4",
            measurementId: "G-HEN3V080PD"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // Check user's authentication state
        auth.onAuthStateChanged(function(user) {
            if (user) {
                // User is logged in, show logout link and add "Home" link
                document.getElementById('logoutli').style.display = 'block';
                
                const navMobile = document.getElementById('nav-mobile');
                const homeLink = document.createElement('li');
                homeLink.innerHTML = `<a href="https://mitesh957.github.io/PawMatch/index1.html">Home</a>`;
                navMobile.appendChild(homeLink);

                document.getElementById('loginli').style.display = 'none';
                document.getElementById('signupli').style.display = 'none';
            } else {
                // User is not logged in, hide logout link and "Home" link
                document.getElementById('logoutli').style.display = 'none';

                document.getElementById('loginli').style.display = 'block';
                document.getElementById('signupli').style.display = 'block';
            }
        });
    </script>

    <!-- Firebase and custom scripts -->
    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-storage.js"></script>
    <script src="./scripts/auth.js"></script>
    <script src="./scripts/firestore-db.js"></script>
</body>
</html>
